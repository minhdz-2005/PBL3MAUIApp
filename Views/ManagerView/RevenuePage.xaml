<ContentPage
  x:Class="PBL3MAUIApp.Views.ManagerView.RevenuePage"
  xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
  xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
  xmlns:converters="clr-namespace:PBL3_Interface.Converters"
  BackgroundColor="#F7EFE9"
  ControlTemplate="{StaticResource SharedManagerPageTemplate}">
  <Grid RowDefinitions="Auto,*">
    <VerticalStackLayout Grid.Row="0">
      <Label
        FontSize="30"
        HorizontalOptions="Center"
        Text="ðŸ“ˆ" />
      <Label
        FontAttributes="Bold"
        FontSize="28"
        HorizontalOptions="Center"
        Text="Thá»‘ng kÃª doanh thu"
        TextColor="Black"
        TextTransform="Uppercase" />
    </VerticalStackLayout>
    <Frame
      Grid.Row="1"
      Margin="50,0,50,10"
      BackgroundColor="Transparent">
      <Grid BackgroundColor="Transparent" RowDefinitions="Auto, Auto, *">
        <!--  Header: Bá»™ lá»c thá»i gian  -->
        <Frame
          Margin="0,0,0,20"
          Padding="15"
          BackgroundColor="#4A90E2"
          CornerRadius="10"
          HasShadow="True">
          <Grid ColumnDefinitions="*, Auto, Auto">
            <Picker
              Title="Chá»n khoáº£ng thá»i gian"
              Margin="5,0"
              BackgroundColor="White"
              HorizontalOptions="FillAndExpand"
              SelectedItem="{Binding SelectedTimeRange, Mode=TwoWay}">
              <Picker.Items>
                <x:String>NgÃ y</x:String>
                <x:String>Tuáº§n</x:String>
                <x:String>ThÃ¡ng</x:String>
                <x:String>NÄƒm</x:String>
              </Picker.Items>
            </Picker>
            <DatePicker
              Margin="10,0,0,0"
              BackgroundColor="White"
              Date="{Binding SelectedDate, Mode=TwoWay}"
              Format="d"
              HorizontalOptions="FillAndExpand"
              IsVisible="{Binding IsDateVisible}" />
            <Button
              Margin="10,0,0,0"
              Padding="10,5"
              BackgroundColor="White"
              Command="{Binding FilterCommand}"
              CommandParameter="{Binding SelectedDate}"
              CornerRadius="5"
              Text="Lá»c"
              TextColor="#4A90E2" />
          </Grid>
        </Frame>

        <!--  Tab Selection  -->
        <HorizontalStackLayout
          Grid.Row="1"
          Margin="0,0,0,10"
          Spacing="10">
          <Button
            Padding="15,5"
            BackgroundColor="{Binding IsTotalRevenueSelected, Converter={StaticResource BoolToColorConverter}, ConverterParameter='Active'}"
            Command="{Binding SelectTabCommand}"
            CommandParameter="TotalRevenue"
            Text="Tá»•ng doanh thu"
            TextColor="White" />
          <Button
            Padding="15,5"
            BackgroundColor="{Binding IsHourlyRevenueSelected, Converter={StaticResource BoolToColorConverter}, ConverterParameter='Active'}"
            Command="{Binding SelectTabCommand}"
            CommandParameter="HourlyRevenue"
            Text="Theo khung giá»"
            TextColor="White" />
          <Button
            Padding="15,5"
            BackgroundColor="{Binding IsProductRevenueSelected, Converter={StaticResource BoolToColorConverter}, ConverterParameter='Active'}"
            Command="{Binding SelectTabCommand}"
            CommandParameter="ProductRevenue"
            Text="Theo sáº£n pháº©m"
            TextColor="White" />
          <Button
            Padding="15,5"
            BackgroundColor="{Binding IsEmployeeRevenueSelected, Converter={StaticResource BoolToColorConverter}, ConverterParameter='Active'}"
            Command="{Binding SelectTabCommand}"
            CommandParameter="EmployeeRevenue"
            Text="Theo nhÃ¢n viÃªn"
            TextColor="White" />
          <Button
            Padding="15,5"
            BackgroundColor="{Binding IsCancellationRateSelected, Converter={StaticResource BoolToColorConverter}, ConverterParameter='Active'}"
            Command="{Binding SelectTabCommand}"
            CommandParameter="CancellationRate"
            Text="Tá»‰ lá»‡ há»§y/Ä‘á»•i"
            TextColor="White" />
          <Button
            Padding="15,5"
            BackgroundColor="{Binding IsDiscountSelected, Converter={StaticResource BoolToColorConverter}, ConverterParameter='Active'}"
            Command="{Binding SelectTabCommand}"
            CommandParameter="Discount"
            Text="Chiáº¿t kháº¥u"
            TextColor="White" />
          <Button
            Padding="15,5"
            BackgroundColor="{Binding IsProfitMarginSelected, Converter={StaticResource BoolToColorConverter}, ConverterParameter='Active'}"
            Command="{Binding SelectTabCommand}"
            CommandParameter="ProfitMargin"
            Text="Tá»· suáº¥t lá»£i nhuáº­n"
            TextColor="White" />
        </HorizontalStackLayout>

        <!--  Content: Dá»¯ liá»‡u thá»‘ng kÃª  -->
        <ScrollView Grid.Row="2">
          <VerticalStackLayout Spacing="15">
            <Label
              FontAttributes="Bold"
              FontSize="18"
              IsVisible="{Binding IsTotalRevenueSelected}"
              Text="{Binding TotalRevenueText}"
              TextColor="#333333" />
            <Label
              FontAttributes="Bold"
              FontSize="18"
              IsVisible="{Binding IsHourlyRevenueSelected}"
              Text="{Binding HourlyRevenueText}"
              TextColor="#333333" />
            <CollectionView
              EmptyView="KhÃ´ng cÃ³ dá»¯ liá»‡u sáº£n pháº©m"
              IsVisible="{Binding IsProductRevenueSelected}"
              ItemsSource="{Binding ProductRevenueList}">
              <CollectionView.ItemTemplate>
                <DataTemplate>
                  <Frame
                    Margin="0,0,0,5"
                    Padding="10"
                    BackgroundColor="#E6F3FA"
                    CornerRadius="5">
                    <Grid ColumnDefinitions="*, *, *">
                      <Label
                        Grid.Column="0"
                        Text="{Binding ProductName}"
                        TextColor="#333333" />
                      <Label
                        Grid.Column="1"
                        Text="{Binding Revenue, StringFormat='Doanh thu: {0:N0} VNÄ'}"
                        TextColor="#333333" />
                      <Label
                        Grid.Column="2"
                        Text="{Binding Profit, StringFormat='Lá»£i nhuáº­n: {0:N0} VNÄ'}"
                        TextColor="#333333" />
                    </Grid>
                  </Frame>
                </DataTemplate>
              </CollectionView.ItemTemplate>
            </CollectionView>
            <CollectionView
              EmptyView="KhÃ´ng cÃ³ dá»¯ liá»‡u nhÃ¢n viÃªn"
              IsVisible="{Binding IsEmployeeRevenueSelected}"
              ItemsSource="{Binding EmployeeRevenueList}">
              <CollectionView.ItemTemplate>
                <DataTemplate>
                  <Frame
                    Margin="0,0,0,5"
                    Padding="10"
                    BackgroundColor="#E6F3FA"
                    CornerRadius="5">
                    <Grid ColumnDefinitions="*, *, *">
                      <Label
                        Grid.Column="0"
                        Text="{Binding EmployeeName}"
                        TextColor="#333333" />
                      <Label
                        Grid.Column="1"
                        Text="{Binding OrdersCount, StringFormat='Sá»‘ Ä‘Æ¡n: {0}'}"
                        TextColor="#333333" />
                      <Label
                        Grid.Column="2"
                        Text="{Binding AverageOrderValue, StringFormat='GiÃ¡ trá»‹ tb: {0:N0} VNÄ'}"
                        TextColor="#333333" />
                    </Grid>
                  </Frame>
                </DataTemplate>
              </CollectionView.ItemTemplate>
            </CollectionView>
            <Label
              FontAttributes="Bold"
              FontSize="18"
              IsVisible="{Binding IsCancellationRateSelected}"
              Text="{Binding CancellationRateText}"
              TextColor="#333333" />
            <Label
              FontAttributes="Bold"
              FontSize="18"
              IsVisible="{Binding IsDiscountSelected}"
              Text="{Binding DiscountText}"
              TextColor="#333333" />
            <Label
              FontAttributes="Bold"
              FontSize="18"
              IsVisible="{Binding IsProfitMarginSelected}"
              Text="{Binding ProfitMarginText}"
              TextColor="#333333" />
          </VerticalStackLayout>
        </ScrollView>
      </Grid>
    </Frame>
  </Grid>
</ContentPage>
